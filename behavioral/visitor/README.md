# 访问者模式

动物园中有多个场馆，比如豹子馆，海豚馆，大象馆等等，不同场馆的票价是不一样的。另外，动物园针对不同类型的游客收费方式也不一样，比如学生半价。

这个场景下，包括以下要素：动物园，动物园中的各个场馆，不同类型的游客，不同类型的游客票价不同。
动物园就相当于一个对象结构，该结构包含具体的元素（各个场馆），每个场馆（元素）都有接待游客（Visitor）的方法（Accept）。

这些被处理的数据元素相对稳定（动物园中的场馆一般比较稳定）而访问方式多种多样（比如学生散客，学生团体，普通游客，团体游客等不同的访问方式）的数据结构，如果用“访问者模式”来处理比较方便。

访问者模式（Visitor Pattern）允许你定义一些操作，可以应用于一个对象结构的元素，而不会改变类。这使得可以在不改变元素类的情况下，新建操作并对其应用于元素类。访问者模式能够使得执行的操作独立于对象结构，同时也增加了在结构上增加新操作的灵活性。

# 访问者模式的结构

通过上面场景的分析，访问者（Visitor）模式实现的关键是如何将作用于元素的操作分离出来封装成独立的类，其基本结构如下：

抽象的访问者（Visitor）：访问具体元素的接口，为每个具体元素类对应一个访问操作 VisitXX() ，其参数为某个具体的元素。
具体的访问者（ConcreteVisitor）：实现抽象访问者角色中声明的各个访问操作，确定访问者访问一个元素时该做什么。
抽象元素（Element）：声明一个包含接受操作 Accept() 的接口，其参数为访问者对象（游客）。
具体元素（ConcreteElement）：实现抽象元素角色提供的 accept() 操作，其方法体通常都是 visitor.visitXX(this) ，另外具体元素中可能还包含本身业务逻辑的相关操作。
对象结构（Object Structure）：一个包含元素角色的容器，提供让访问者对象遍历容器中的所有元素的方法，通常由 List、Set、Map 等聚合类实现。本例中的动物园就可抽象成一个对象结构。

在 Go 语言中，访问者模式可以通过接口和方法的方式来实现。首先，我们定义一个接口用于表示访问者的行为，访问者接口可以定义多个访问方法对应不同类型的元素。然后，我们为每种元素类型定义一个具体的元素结构体，并为这些元素结构体实现接口定义的访问方法。
